#!/usr/bin/python3
# coding: UTF-8

import sys
from scapy.all import IP, TCP, sr1

target_ip = sys.argv[1]
target_port = int(sys.argv[2])

ip_layer = IP(dst=target_ip)

# SYNパケットを作成する
syn_packet = ip_layer/TCP(dport=target_port, flags='S')

# SYNパケットを送信し、レスポンスを取得する
print('Send SYN packet:')
response_packet = sr1(syn_packet)
print(f'Response: {response_packet}')
print('-----------------------------------')

# TODO: 書いてください!
# SYN/ACKパケットが返ってきた場合、ACKパケットを送信する
# if 

# RSTパケットが返ってきた場合、ポートは閉じていると判断する
#else:
#   print(f'TCP port {target_port} is closed')
