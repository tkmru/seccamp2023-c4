FROM ubuntu:22.04
ARG DEBIAN_FRONTEND=noninteractive
ENV TZ=Asia/Tokyo
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

# Install necessary packages
RUN apt update && apt upgrade -y
RUN apt install -y software-properties-common && add-apt-repository ppa:deadsnakes/ppa
RUN apt -y install --fix-missing \
        curl \
        sudo \
        dnsutils \
        iproute2 \
        iptables \
        iputils-ping \
        net-tools \
        tcpdump \
        nmap \
        python3.11 \
        emacs \
        nano \
        vim \
        ssh

RUN curl -sS https://bootstrap.pypa.io/get-pip.py | python3.11
RUN pip3 install \
    cffi \
    scapy \
    cryptography \
    ipython

RUN useradd -m -s /bin/bash pentester \
    && usermod -aG sudo pentester \
    && echo "root:seccamp" | chpasswd \
    && echo "pentester:seccamp" | chpasswd

RUN echo "alias sudo='sudo '" >> ~/.bashrc
RUN echo "alias python='python3.11'" >> ~/.bashrc
RUN cp /root/.bashrc /home/pentester/.bashrc

COPY ./pentester/code /home/pentester/code
RUN chown -R pentester /home/pentester

USER pentester
WORKDIR /home/pentester
